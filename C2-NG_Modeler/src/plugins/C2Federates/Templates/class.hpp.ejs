<% /*class(isinteraction,simname,classname,parentclassname,hlaclassname,datamembers,alldatamembers,isc2winteractionroot) ::= << */ %>
/*
 * Copyright (c) 2008, Institute for Software Integrated Systems, Vanderbilt University
 * All rights reserved.
 *
 * Permission to use, copy, modify, and distribute this software and its
 * documentation for any purpose, without fee, and without written agreement is
 * hereby granted, provided that the above copyright notice, the following
 * two paragraphs and the author appear in all copies of this software.
 *
 * IN NO EVENT SHALL THE VANDERBILT UNIVERSITY BE LIABLE TO ANY PARTY FOR
 * DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING OUT
 * OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF THE VANDERBILT
 * UNIVERSITY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * THE VANDERBILT UNIVERSITY SPECIFICALLY DISCLAIMS ANY WARRANTIES,
 * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE PROVIDED HEREUNDER IS
 * ON AN "AS IS" BASIS, AND THE VANDERBILT UNIVERSITY HAS NO OBLIGATION TO
 * PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.
 *
 * @author Himanshu Neema
 * @author Harmon Nine
 */

// This code has been generated by the C2W code generator.
// Do not edit manually!

/*
 * 	NOTE:  ALL "if" STATEMENTS IN THIS CODE THAT HAD THE FORM:
 *
 *  if (condition) statement;
 *
 *	OR
 *
 *  if (condition) statement1;
 *  else           statement2;
 *
 *  HAVE BEEN CONVERTED TO THE FORMS:
 *
 *  if (condition) {
 *		statement;
 *	}
 *
 *	AND
 *
 *  if (condition) {
 *		statement1;
 *	} else {
 *		statement2;
 *	}
 *
 *	RESPECTIVELY.  THIS IS BECAUSE THE OMNET DEBUGGER APPEARS TO HAVE A PROBLEM
 *  WITH THE NON-BRACED FORMS OF THE IF STATEMENT.  *PLEASE* DO NOT CHANGE IT BACK.
 *  -- H.S.N.
 *
 */

#ifndef _<%=classname%>_CLASS
#define _<%=classname%>_CLASS

#include "<%=parentclassname%>.hpp"
#include "C2WException.hpp"


class <%=classname%> : public <%=parentclassname%> {

public:
	typedef <%=parentclassname%> Super;
	typedef boost::shared_ptr< <%=classname%> > SP;

	static StringVector get_<%=isinteraction?"parameter":"attribute"%>_names() {
		return getDatamemberNames();
	}

	static StringVector get_all_<%=isinteraction?"parameter":"attribute"%>_names() {
		return getAllDatamemberNames();
	}

	<%=classname%>( void ) { }
	
	static SP create( void ) { return SP( new <%=classname%> ); }

private:
	<% /*datamembers:handle()*/ %>
	<% datamembers.forEach(function(datamember){ %>
	static int &get_<%=datamember.name%>_handle_var( void ) {
		static int <%=datamember.name%>_handle;
		return <%=datamember.name%>_handle;
	}<%});%>
	
public:
	<% /*datamembers:gethandle()*/ %>
	<% datamembers.forEach(function(datamember){ %>
	static int get_<%=datamember.name%>_handle( void ) { return get_<%=datamember.name%>_handle_var(); }<%});%>
	
<% /*classcommon(...)*/ %>
<%-ejs.render(
	TEMPLATES["classcommon.hpp.ejs"],{
		isinteraction: isinteraction,
		classname: classname,
		parentclassname: parentclassname,
		hlaclassname: hlaclassname,
		datamembers: datamembers,
		alldatamembers: alldatamembers
})%>

<% if(isc2winteractionroot){ %>
public:
	void sendInteraction( RTI::RTIambassador *rti, double time );
	void sendInteraction( RTI::RTIambassador *rti );
	
<%}%>

<% if(isinteraction){ %>
private:
	<% /*datamembers:interactionmembers()*/ %>
	<% datamembers.forEach(function(datamember){ %>
	<%- helpers.cppjavaTypeMap(datamember.parameterType) %> _<%=datamember.name%>;
	<%});%>
public:
	<% /*datamembers:interactiongetters()*/ -%>
	<% datamembers.forEach(function(datamember){ %>
	void set_<%=datamember.name%>( <%- helpers.cppjavaArgumentTypeMap(datamember.parameterType) %> <%=datamember.name%> ) { _<%=datamember.name%> = <%=datamember.name%>; }
	<%- helpers.cppjavaArgumentTypeMap(datamember.parameterType) %> get_<%=datamember.name%>( void ) const { return _<%=datamember.name%>; }
	<%});%>
<% }else{ %>
public:
	<% alldatamembers.forEach(function(attribute){ %>
	<% /*alldatamembers:{ a |<publish(classname=classname,attribute=a)> }*/ %>
	static void publish_<%=attribute.name%>( void ) {
		getPublishAttributeNameVector().push_back( "<%=attribute.name%>" );
	}
	static void unpublish_<%=attribute.name%>( void ) {
		getPublishAttributeNameVector().erase( std::remove( getPublishAttributeNameVector().begin(), getPublishAttributeNameVector().end(), "<%=attribute.name%>" ), getPublishAttributeNameVector().end() );
	}
	<% /*alldatamembers:{ a |<subscribe(classname=classname,attribute=a)> }*/ %>
	static void subscribe_<%=attribute.name%>( void ) {
		getSubscribeAttributeNameVector().push_back( "<%=attribute.name%>" );
	}
	static void unsubscribe_<%=attribute.name%>(void ) {
		getSubscribeAttributeNameVector().erase( std::remove( getSubscribeAttributeNameVector().begin(), getSubscribeAttributeNameVector().end(), "<%=attribute.name%>" ), getSubscribeAttributeNameVector().end() );
	}
	<%});%>
private:
	<% /*datamembers:objectmembers()*/ %>
	<% datamembers.forEach(function(datamember){ %>
	Attribute< int, <%- helpers.cppjavaTypeMap(datamember.parameterType) %> > _<%=datamember.name%>;
	<%});%>
public:
	<% datamembers.forEach(function(datamember){ %>
	<% /*datamembers:objectsetters()*/ %>
	void set_<%=datamember.name%>( <%- helpers.cppjavaArgumentTypeMap(datamember.parameterType) %> <%=datamember.name%> ) {
		_<%=datamember.name%>.setValue( <%=datamember.name%> );
		_<%=datamember.name%>.setTime( getTime() );
	}
	<% /*datamembers:objectgetters()*/ %>
	<%- helpers.cppjavaArgumentTypeMap(datamember.parameterType) %> get_<%=datamember.name%>( void ) const {
		return _<%=datamember.name%>.getValue();
	}
	<% /*datamembers:objecttimegetters()*/ %>
	double get_<%=datamember.name%>_time( void ) {
		return _<%=datamember.name%>.getTime();
	}
	<%});%>
<%}%>

	<%=classname%>( const RTI::<%=isinteraction?"Parameter":"Attribute"%>HandleValuePairSet &datamemberMap ) : Super( datamemberMap ) { }
	
	<%=classname%>( const RTI::<%=isinteraction?"Parameter":"Attribute"%>HandleValuePairSet &datamemberMap, const RTIfedTime &logicalTime ) : Super( datamemberMap, logicalTime ) { }
	
	<% if(datamembers && datamembers.length > 0){ %>
public:
	TypeMedley get<%=isinteraction?"Parameter":"Attribute"%>( const std::string &datamemberName ) const {
		<% /*first(datamembers):startgetbyname()*/ %>
		<% for(var i = 0; i<datamembers.length; i++ ){ %>
		<%= i == 0  ? 'if' : 'else if' %> ( "<%=datamembers[i].name%>" == datamemberName ) {
			return TypeMedley( get_<%=datamembers[i].name%>() );
		}<%}%> else {
			return Super::get<%=isinteraction?"Parameter":"Attribute"%>( datamemberName );
		}
	}
	
	TypeMedley get<%=isinteraction?"Parameter":"Attribute"%>( int datamemberHandle ) const {
		<% /*first(datamembers):startgetbyhandle()*/ %>
		<% for(var i = 0; i<datamembers.length; i++ ){ %>
		<%= i == 0  ? 'if' : 'else if'%> ( get_<%=datamembers[i].name%>_handle() == datamemberHandle ) {
			return TypeMedley( get_<%=datamembers[i].name%>() );
		}<%}%> else {
			return Super::get<%=isinteraction?"Parameter":"Attribute"%>( datamemberHandle );
		}
	}

protected:
	virtual bool set<%=isinteraction?"Parameter":"Attribute"%>Aux( int param_handle, const std::string &val ) {
		bool retval = true;		
		<% /*first(datamembers):startif()*/ %>
		<% for(var i = 0; i<datamembers.length; i++ ){ %>
		<%= i == 0  ? 'if' : 'else if'%> ( param_handle == get_<%=datamembers[i].name%>_handle() ) {
			set_<%=datamembers[i].name%>(  TypeMedley( val )  );
		}<%}%> else {
			retval = Super::set<%=isinteraction?"Parameter":"Attribute"%>Aux( param_handle, val );
		}
		return retval;
	}
	
	virtual bool set<%=isinteraction?"Parameter":"Attribute"%>Aux( const std::string &datamemberName, const std::string &val ) {
		bool retval = true;
		<% /*first(datamembers):startifstring()*/ %>
		<% for(var i = 0; i<datamembers.length; i++ ){ %>
		<%= i == 0  ? 'if' : 'else if'%> ( "<%=datamembers[i].name%>" == datamemberName ) {
			set_<%=datamembers[i].name%>(  TypeMedley( val )  );
		}<%}%> else {
			retval = Super::set<%=isinteraction?"Parameter":"Attribute"%>Aux( datamemberName, val );
		}
		
		return retval;
	}
	
	virtual bool set<%=isinteraction?"Parameter":"Attribute"%>Aux( const std::string &datamemberName, const TypeMedley &val ) {
		bool retval = true;
		<% /*first(datamembers):startifname()*/ %>
		<% for(var i = 0; i<datamembers.length; i++ ){ %>
		<%= i == 0  ? 'if' : 'else if'%> ( "<%=datamembers[i].name%>" == datamemberName ) {\
			set_<%=datamembers[i].name%>( val );
		}<%}%> else {
			retval = Super::set<%=isinteraction?"Parameter":"Attribute"%>Aux( datamemberName, val );
		}
		
		return retval;
	}

	virtual <%=isinteraction?"Parameter":"Attribute"%>HandleValuePairSetSP createDatamemberHandleValuePairSet( RTI::ULong count<% if(!isinteraction){%>, bool force <%}%> );

	virtual <%=isinteraction?"Parameter":"Attribute"%>HandleValuePairSetSP createDatamemberHandleValuePairSet( <% if(!isinteraction){%> bool force <%}%>) {
		return createDatamemberHandleValuePairSet( 0<% if(!isinteraction){%>, force<%}%> );
	}
	<%}%>
	
};

typedef <%=classname%>::SP <%=classname%>SP;

static bool call_<%=classname%>_static_init = <%=classname%>::static_init();

std::ostream &operator<<( std::ostream &os, <%=classname%>::SP entitySP );
std::ostream &operator<<( std::ostream &os, const <%=classname%> &entity );
#endif
